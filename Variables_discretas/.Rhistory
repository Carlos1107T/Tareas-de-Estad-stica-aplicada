Probabilidad = c(1-p_moneda, p_moneda)
)
kable(bernoulli_moneda,
caption = "Distribución Bernoulli - Moneda justa (p = 0.5)",
align = "ccc") %>%
kable_styling(bootstrap_options = "striped")
# Parámetros
media_moneda <- p_moneda
varianza_moneda <- p_moneda * (1 - p_moneda)
desv_std_moneda <- sqrt(varianza_moneda)
cat("Parámetros estadísticos:\n")
cat("Media:", media_moneda, "\n")
cat("Varianza:", varianza_moneda, "\n")
cat("Desviación estándar:", desv_std_moneda, "\n")
#| label: ejemplos-bernoulli-multiple
# Diferentes valores de p
p_values <- c(0.1, 0.3, 0.5, 0.7, 0.9)
# Crear data frame para visualización
bernoulli_data <- data.frame()
for(p in p_values) {
temp_data <- data.frame(
p = paste("p =", p),
x = c(0, 1),
probabilidad = c(1-p, p),
media = p,
varianza = p*(1-p)
)
bernoulli_data <- rbind(bernoulli_data, temp_data)
}
# Tabla de parámetros
param_bernoulli <- data.frame(
p = p_values,
Media = p_values,
Varianza = p_values * (1 - p_values),
Desv_Std = sqrt(p_values * (1 - p_values))
)
kable(param_bernoulli,
caption = "Parámetros de la distribución Bernoulli para diferentes valores de p",
digits = 4,
col.names = c("p", "Media", "Varianza", "Desv. Estándar")) %>%
kable_styling(bootstrap_options = "striped")
#| label: grafico-bernoulli
#| fig-cap: "Distribución Bernoulli para diferentes valores de p"
ggplot(bernoulli_data, aes(x = factor(x), y = probabilidad, fill = factor(x))) +
geom_col(alpha = 0.7) +
geom_text(aes(label = round(probabilidad, 2)), vjust = -0.3) +
facet_wrap(~p, ncol = 5) +
scale_fill_manual(values = c("0" = "red", "1" = "blue")) +
labs(title = "Distribución de Bernoulli para diferentes valores de p",
x = "Valor (0 = Fracaso, 1 = Éxito)",
y = "Probabilidad",
fill = "Resultado") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#| label: binomial-monedas
# Parámetros
n_monedas <- 10
p_monedas <- 0.5
# Calcular probabilidades
k_values <- 0:n_monedas
prob_binomial <- dbinom(k_values, n_monedas, p_monedas)
# Crear data frame
binomial_monedas <- data.frame(
Num_Caras = k_values,
Probabilidad = prob_binomial
)
# Mostrar tabla
kable(binomial_monedas,
caption = paste("Distribución Binomial - 10 lanzamientos de moneda (n =", n_monedas, ", p =", p_monedas, ")"),
digits = 4,
col.names = c("Número de Caras", "Probabilidad")) %>%
kable_styling(bootstrap_options = "striped")
# Parámetros estadísticos
media_monedas <- n_monedas * p_monedas
varianza_monedas <- n_monedas * p_monedas * (1 - p_monedas)
desv_std_monedas <- sqrt(varianza_monedas)
cat("\nParámetros estadísticos:\n")
cat("Media:", media_monedas, "\n")
cat("Varianza:", varianza_monedas, "\n")
cat("Desviación estándar:", round(desv_std_monedas, 4), "\n")
#| label: grafico-binomial-monedas
#| fig-cap: "Distribución Binomial - 10 lanzamientos de moneda"
ggplot(binomial_monedas, aes(x = Num_Caras, y = Probabilidad)) +
geom_col(fill = "steelblue", alpha = 0.7, width = 0.8) +
geom_text(aes(label = round(Probabilidad, 3)), vjust = -0.5, size = 3) +
geom_vline(xintercept = media_monedas, color = "red", linetype = "dashed", size = 1) +
annotate("text", x = media_monedas + 2.5, y = max(prob_binomial) * 0.8,
label = paste("Media =", media_monedas), color = "red") +
scale_x_continuous(breaks = k_values) +
labs(title = paste("Distribución Binomial(", n_monedas, ",", p_monedas, ")"),
x = "Número de Éxitos",
y = "Probabilidad") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
#| label: control-calidad
# Parámetros
n_articulos <- 20
p_defecto <- 0.05
# Probabilidades
k_defectos <- 0:n_articulos
prob_defectos <- dbinom(k_defectos, n_articulos, p_defecto)
# Crear data frame
calidad_data <- data.frame(
Defectos = k_defectos,
Probabilidad = prob_defectos
)
# Filtrar probabilidades significativas (> 0.001)
calidad_filtrada <- calidad_data[calidad_data$Probabilidad > 0.001, ]
kable(calidad_filtrada,
caption = paste("Distribución Binomial - Control de calidad (n =", n_articulos, ", p =", p_defecto, ")"),
digits = 4,
col.names = c("Número de Defectos", "Probabilidad")) %>%
kable_styling(bootstrap_options = "striped")
# Parámetros estadísticos
media_defectos <- n_articulos * p_defecto
varianza_defectos <- n_articulos * p_defecto * (1 - p_defecto)
desv_std_defectos <- sqrt(varianza_defectos)
cat("Parámetros estadísticos:\n")
cat("Media:", media_defectos, "\n")
cat("Varianza:", round(varianza_defectos, 4), "\n")
cat("Desviación estándar:", round(desv_std_defectos, 4), "\n")
# Probabilidades importantes
prob_0_defectos <- dbinom(0, n_articulos, p_defecto)
prob_max_2_defectos <- pbinom(2, n_articulos, p_defecto)
prob_mas_3_defectos <- 1 - pbinom(3, n_articulos, p_defecto)
cat("\nProbabilidades de interés:\n")
cat("P(0 defectos):", round(prob_0_defectos, 4), "\n")
cat("P(≤ 2 defectos):", round(prob_max_2_defectos, 4), "\n")
cat("P(> 3 defectos):", round(prob_mas_3_defectos, 4), "\n")
#| label: grafico-calidad
#| fig-cap: "Distribución Binomial - Control de calidad"
ggplot(calidad_data[1:8, ], aes(x = Defectos, y = Probabilidad)) +
geom_col(fill = "darkgreen", alpha = 0.7, width = 0.8) +
geom_text(aes(label = round(Probabilidad, 4)), vjust = -0.5, size = 3) +
geom_vline(xintercept = media_defectos, color = "red", linetype = "dashed", size = 1) +
annotate("text", x = media_defectos + 1.2, y = max(prob_defectos) * 0.6,
label = paste("Media =", media_defectos), color = "red") +
scale_x_continuous(breaks = 0:7) +
labs(title = paste("Distribución Binomial(", n_articulos, ",", p_defecto, ")"),
subtitle = "Control de calidad - Artículos defectuosos",
x = "Número de Artículos Defectuosos",
y = "Probabilidad") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
#| label: efecto-n
# Diferentes valores de n con p fijo
n_vals <- c(5, 10, 20, 50)
p_fijo <- 0.3
# Crear data frame para comparación
comp_n_data <- data.frame()
for(n in n_vals) {
k_vals <- 0:n
probs <- dbinom(k_vals, n, p_fijo)
temp_data <- data.frame(
n = paste("n =", n),
k = k_vals,
probabilidad = probs,
media = n * p_fijo,
varianza = n * p_fijo * (1 - p_fijo)
)
comp_n_data <- rbind(comp_n_data, temp_data)
}
# Filtrar para visualización (solo valores con probabilidad > 0.01)
comp_n_filtered <- comp_n_data[comp_n_data$probabilidad > 0.01, ]
ggplot(comp_n_filtered, aes(x = k, y = probabilidad)) +
geom_col(fill = "purple", alpha = 0.7, width = 0.8) +
facet_wrap(~n, scales = "free") +
labs(title = paste("Efecto del parámetro n (p =", p_fijo, ")"),
x = "Número de Éxitos",
y = "Probabilidad") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
#| label: efecto-p
#| fig-cap: "Efecto del parámetro p en la distribución binomial"
# Diferentes valores de p con n fijo
p_vals <- c(0.1, 0.3, 0.5, 0.7, 0.9)
n_fijo <- 10
# Crear data frame para comparación
comp_p_data <- data.frame()
for(p in p_vals) {
k_vals <- 0:n_fijo
probs <- dbinom(k_vals, n_fijo, p)
temp_data <- data.frame(
p = paste("p =", p),
k = k_vals,
probabilidad = probs,
media = n_fijo * p,
varianza = n_fijo * p * (1 - p)
)
comp_p_data <- rbind(comp_p_data, temp_data)
}
ggplot(comp_p_data, aes(x = k, y = probabilidad)) +
geom_col(fill = "orange", alpha = 0.7, width = 0.8) +
geom_vline(aes(xintercept = media), color = "blue", linetype = "dashed") +
facet_wrap(~p, scales = "free_y") +
labs(title = paste("Efecto del parámetro p (n =", n_fijo, ")"),
x = "Número de Éxitos",
y = "Probabilidad") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
#| label: simulacion-binomial
set.seed(456)
n_trials <- 15
p_sim_bin <- 0.4
n_sim_bin <- 1000
# Generar datos
datos_binomial <- rbinom(n_sim_bin, n_trials, p_sim_bin)
# Calcular estadísticas observadas
media_obs_bin <- mean(datos_binomial)
var_obs_bin <- var(datos_binomial)
# Valores teóricos
media_teo_bin <- n_trials * p_sim_bin
var_teo_bin <- n_trials * p_sim_bin * (1 - p_sim_bin)
cat("Media teórica:", media_teo_bin, "| Media observada:", round(media_obs_bin, 4), "\n")
cat("Varianza teórica:", var_teo_bin, "| Varianza observada:", round(var_obs_bin, 4), "\n")
# Comparar distribuciones
freq_obs_bin <- table(datos_binomial) / n_sim_bin
k_sim <- as.numeric(names(freq_obs_bin))
freq_teo_bin <- dbinom(k_sim, n_trials, p_sim_bin)
comparacion_bin <- data.frame(
k = k_sim,
Freq_Observada = as.numeric(freq_obs_bin),
Prob_Teorica = freq_teo_bin
)
kable(head(comparacion_bin, 10),
caption = "Comparación frecuencias observadas vs probabilidades teóricas",
digits = 4,
col.names = c("k", "Freq. Observada", "Prob. Teórica")) %>%
kable_styling(bootstrap_options = "striped")
#| label: relacion-bernoulli-binomial
set.seed(789)
n_exp <- 8
p_exp <- 0.6
n_sim_rel <- 1000
# Método 1: Generar directamente de Binomial
binomial_directo <- rbinom(n_sim_rel, n_exp, p_exp)
# Método 2: Sumar n variables Bernoulli independientes
suma_bernoulli <- replicate(n_sim_rel, {
bernoulli_vars <- rbinom(n_exp, 1, p_exp)
sum(bernoulli_vars)
})
# Comparar distribuciones
comparacion_relacion <- data.frame(
Binomial_Directo = binomial_directo,
Suma_Bernoulli = suma_bernoulli
)
# Visualización comparativa
comp_rel_long <- comparacion_relacion %>%
mutate(id = row_number()) %>%
pivot_longer(cols = c(Binomial_Directo, Suma_Bernoulli),
names_to = "Metodo",
values_to = "Valor")
ggplot(comp_rel_long, aes(x = Valor, fill = Metodo)) +
geom_histogram(alpha = 0.6, position = "identity", bins = n_exp + 1) +
scale_fill_manual(values = c("Binomial_Directo" = "blue", "Suma_Bernoulli" = "red")) +
labs(title = "Equivalencia: Binomial vs Suma de Bernoulli",
subtitle = paste("n =", n_exp, ", p =", p_exp),
x = "Valor",
y = "Frecuencia",
fill = "Método") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom")
#| label: relacion-bernoulli-binomial
set.seed(789)
n_exp <- 8
p_exp <- 0.6
n_sim_rel <- 1000
# Método 1: Generar directamente de Binomial
binomial_directo <- rbinom(n_sim_rel, n_exp, p_exp)
# Método 2: Sumar n variables Bernoulli independientes
suma_bernoulli <- replicate(n_sim_rel, {
bernoulli_vars <- rbinom(n_exp, 1, p_exp)
sum(bernoulli_vars)
})
# Comparar distribuciones
comparacion_relacion <- data.frame(
Binomial_Directo = binomial_directo,
Suma_Bernoulli = suma_bernoulli
)
# Visualización comparativa
comp_rel_long <- comparacion_relacion %>%
mutate(id = row_number()) %>%
pivot_longer(cols = c(Binomial_Directo, Suma_Bernoulli),
names_to = "Metodo",
values_to = "Valor")
ggplot(comp_rel_long, aes(x = Valor, fill = Metodo)) +
geom_histogram(alpha = 0.6, position = "dodge", binwidth  = 1) +
scale_fill_manual(values = c("Binomial_Directo" = "blue", "Suma_Bernoulli" = "red")) +
scale_x_continuous(breaks = 0:n_exp+1, center = 0)
labs(title = "Equivalencia: Binomial vs Suma de Bernoulli",
subtitle = paste("n =", n_exp, ", p =", p_exp),
x = "Valor",
y = "Frecuencia",
fill = "Método") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom")
#| label: relacion-bernoulli-binomial
set.seed(789)
n_exp <- 8
p_exp <- 0.6
n_sim_rel <- 1000
# Método 1: Generar directamente de Binomial
binomial_directo <- rbinom(n_sim_rel, n_exp, p_exp)
# Método 2: Sumar n variables Bernoulli independientes
suma_bernoulli <- replicate(n_sim_rel, {
bernoulli_vars <- rbinom(n_exp, 1, p_exp)
sum(bernoulli_vars)
})
# Comparar distribuciones
comparacion_relacion <- data.frame(
Binomial_Directo = binomial_directo,
Suma_Bernoulli = suma_bernoulli
)
# Visualización comparativa
comp_rel_long <- comparacion_relacion %>%
mutate(id = row_number()) %>%
pivot_longer(cols = c(Binomial_Directo, Suma_Bernoulli),
names_to = "Metodo",
values_to = "Valor")
ggplot(comp_rel_long, aes(x = Valor, fill = Metodo)) +
geom_histogram(alpha = 0.6, position = "dodge", binwidth  = 1) +
scale_fill_manual(values = c("Binomial_Directo" = "blue", "Suma_Bernoulli" = "red")) +
scale_x_continuous(breaks = 0:n_exp +1, center = 0)
labs(title = "Equivalencia: Binomial vs Suma de Bernoulli",
subtitle = paste("n =", n_exp, ", p =", p_exp),
x = "Valor",
y = "Frecuencia",
fill = "Método") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom")
#| label: relacion-bernoulli-binomial
set.seed(789)
n_exp <- 8
p_exp <- 0.6
n_sim_rel <- 1000
# Método 1: Generar directamente de Binomial
binomial_directo <- rbinom(n_sim_rel, n_exp, p_exp)
# Método 2: Sumar n variables Bernoulli independientes
suma_bernoulli <- replicate(n_sim_rel, {
bernoulli_vars <- rbinom(n_exp, 1, p_exp)
sum(bernoulli_vars)
})
# Comparar distribuciones
comparacion_relacion <- data.frame(
Binomial_Directo = binomial_directo,
Suma_Bernoulli = suma_bernoulli
)
# Visualización comparativa
comp_rel_long <- comparacion_relacion %>%
mutate(id = row_number()) %>%
pivot_longer(cols = c(Binomial_Directo, Suma_Bernoulli),
names_to = "Metodo",
values_to = "Valor")
ggplot(comp_rel_long, aes(x = Valor, fill = Metodo)) +
geom_histogram(alpha = 0.6, position = "dodge", binwidth  = 1, center =0) +
scale_fill_manual(values = c("Binomial_Directo" = "blue", "Suma_Bernoulli" = "red")) +
scale_x_continuous(breaks = 0:n_exp )
labs(title = "Equivalencia: Binomial vs Suma de Bernoulli",
subtitle = paste("n =", n_exp, ", p =", p_exp),
x = "Valor",
y = "Frecuencia",
fill = "Método") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom")
#| label: relacion-bernoulli-binomial
set.seed(789)
n_exp <- 8
p_exp <- 0.6
n_sim_rel <- 1000
# Método 1: Generar directamente de Binomial
binomial_directo <- rbinom(n_sim_rel, n_exp, p_exp)
# Método 2: Sumar n variables Bernoulli independientes
suma_bernoulli <- replicate(n_sim_rel, {
bernoulli_vars <- rbinom(n_exp, 1, p_exp)
sum(bernoulli_vars)
})
# Comparar distribuciones
comparacion_relacion <- data.frame(
Binomial_Directo = binomial_directo,
Suma_Bernoulli = suma_bernoulli
)
# Visualización comparativa
comp_rel_long <- comparacion_relacion %>%
mutate(id = row_number()) %>%
pivot_longer(cols = c(Binomial_Directo, Suma_Bernoulli),
names_to = "Metodo",
values_to = "Valor")
ggplot(comp_rel_long, aes(x = Valor, fill = Metodo)) +
geom_histogram(alpha = 0.6, position = "dodge", binwidth  = 1, center =0) +
scale_fill_manual(values = c("Binomial_Directo" = "blue", "Suma_Bernoulli" = "red")) +
scale_x_continuous(breaks = 0:n_exp )+
labs(title = "Equivalencia: Binomial vs Suma de Bernoulli",
subtitle = paste("n =", n_exp, ", p =", p_exp),
x = "Valor",
y = "Frecuencia",
fill = "Método") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom")
#| label: setup
#| include: false
library(tidyverse)
library(kableExtra)
library(gridExtra)
P <- 0.7
k_values <- 0.7
jugador <- tibble(k_vals,
probabilidad = dgeom(Tiros,p))
P <- 0.7
k_values <- 0:5
jugador <- tibble(k_vals,
probabilidad = dgeom(Tiros,p))
P <- 0.7
k_values <- 0:5
jugador <- tibble(k_vals,
probabilidad = dgeom(Tiros,P))
ggplo
p <- 0.7
k_values <- 0:5
jugador <- tibble(Tiros = k_vals,
probabilidad = dgeom(Tiros,p))
ggplot(jugador)+
geom_col(aes(Tiros, Probabilidad),fill ="#ABE121", alpha = 0.2, color = "black")+
theme_bw()
p <- 0.7
k_values <- 0:5
jugador <- tibble(Tiros = k_vals,
probabilidad = dgeom(Tiros,p))
ggplot(jugador)+
geom_col(aes(Tiros, probabilidad),fill ="#ABE121", alpha = 0.2, color = "black")+
theme_bw()
esperanza <- (1-p)/p
cat("b) El número de intentos que se espera que necesite para anotar:", esperanza+1)
library(ggplot2)
library(dplyr)
library(knitr)
library(gridExtra)
library(patchwork)
X<- rpois(2000, lambda = 3.5)
ggplot()+
geom_histogram(aes(X))
X<- rpois(2000, lambda = 3.5)
ggplot()+
geom_histogram(aes(X), bins = 10)
X<- rpois(2000, lambda = 3.5)
Y<- rpois(2000, lambda = 2.8)
Suma <- X+Y
Suma_terica <- rpois(2000, lambda = 6.3)
ejercicio_pois <- tibble(Valor =Suma, Tipo = "Suma")
ggplot()+
geom_histogram(aes(X), bins = 10)
X<- rpois(2000, lambda = 3.5)
Y<- rpois(2000, lambda = 2.8)
Suma <- X+Y
Suma_terica <- rpois(2000, lambda = 6.3)
ejercicio_pois <- tibble(Valor =Suma, Tipo = "Suma")
ejercicio_pois_2 <- tibble(Valor =Suma, Tipo = "Suma Teorica")
ejercicio_pois_total <- bind_rows(ejercicio_pois,ejercicio_pois_2)
ggplot(ejer_pois_total)+
geom_histogram(aes(Valor, fill = Tipo),position ="dodge", bins = 10)+
theme_bw()
X<- rpois(2000, lambda = 3.5)
Y<- rpois(2000, lambda = 2.8)
Suma <- X+Y
Suma_terica <- rpois(2000, lambda = 6.3)
ejercicio_pois <- tibble(Valor =Suma, Tipo = "Suma")
ejercicio_pois_2 <- tibble(Valor =Suma, Tipo = "Suma Teorica")
ejercicio_pois_total <- bind_rows(ejercicio_pois,ejercicio_pois_2)
ggplot(ejercicio_pois_total)+
geom_histogram(aes(Valor, fill = Tipo),position ="dodge", bins = 10)+
theme_bw()
X<- rpois(2000, lambda = 3.5)
Y<- rpois(2000, lambda = 2.8)
Suma <- X+Y
Suma_terica <- rpois(2000, lambda = 6.3)
ejercicio_pois <- tibble(Valor =Suma, Tipo = "Suma")
ejercicio_pois_2 <- tibble(Valor =Suma, Tipo = "Suma Teorica")
ejercicio_pois_total <- bind_rows(ejercicio_pois,ejercicio_pois_2)
ggplot(ejercicio_pois_total)+
geom_histogram(aes(Valor, fill = Tipo),position ="dodge2", center = 0, binwidth = 1)+
theme_bw()
X<- rpois(2000, lambda = 3.5)
Y<- rpois(2000, lambda = 2.8)
Suma <- X+Y
Suma_terica <- rpois(2000, lambda = 6.3)
ejercicio_pois <- tibble(Valor =Suma, Tipo = "Suma")
ejercicio_pois_2 <- tibble(Valor =Suma, Tipo = "Suma Teorica")
ejercicio_pois_total <- bind_rows(ejercicio_pois,ejercicio_pois_2)
ggplot(ejercicio_pois_total)+
geom_histogram(aes(Valor, fill = Tipo),position ="dodge2", center = 0, binwidth = 1)+
theme_bw()
X<- rpois(2000, lambda = 3.5)
Y<- rpois(2000, lambda = 2.8)
Suma <- X+Y
Suma_teorica <- rpois(2000, lambda = 6.3)
ejercicio_pois <- tibble(Valor =Suma, Tipo = "Suma")
ejercicio_pois_2 <- tibble(Valor =Suma_teorica, Tipo = "Suma Teorica")
ejercicio_pois_total <- bind_rows(ejercicio_pois,ejercicio_pois_2)
ggplot(ejercicio_pois_total)+
geom_histogram(aes(Valor, fill = Tipo),position ="dodge2", center = 0, binwidth = 1)+
theme_bw()
